<td>
  {% set myp = user_predictions.get(f.id) %}
  {% if f.is_open_for_prediction() %}
    <!-- Standalone form just for this fixture -->
    <form id="pick-{{ f.id }}" method="post"
          action="{{ url_for('predict', fixture_id=f.id) }}"
          class="d-inline-flex flex-wrap gap-2 mb-0"
          autocomplete="off" novalidate>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="selection" id="p1-{{ f.id }}" value="1"
               {% if myp and myp.selection == '1' %}checked{% endif %}>
        <label class="form-check-label" for="p1-{{ f.id }}">1</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="selection" id="px-{{ f.id }}" value="X"
               {% if myp and myp.selection == 'X' %}checked{% endif %}>
        <label class="form-check-label" for="px-{{ f.id }}">X</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio" name="selection" id="p2-{{ f.id }}" value="2"
               {% if myp and myp.selection == '2' %}checked{% endif %}>
        <label class="form-check-label" for="p2-{{ f.id }}">2</label>
      </div>
    </form>

    <!-- Button is OUTSIDE the form and explicitly bound to it -->
    <button type="submit" class="btn btn-primary btn-sm"
            form="pick-{{ f.id }}" formmethod="post" formenctype="application/x-www-form-urlencoded">
      Save
    </button>
  {% else %}
    {% if myp %}
      <span class="badge text-bg-secondary">Locked: {{ myp.selection }}</span>
    {% else %}
      <span class="badge text-bg-secondary">Locked</span>
    {% endif %}
  {% endif %}
</td>
